---
title:  "WIP - Escher"
mathjax: true
layout: post
categories: media
---

<!-- ![Print Gallery Escher](/assets/pictures/Escher/Print_gallery.png =250x250) -->

<img src="https://media.nga.gov/iiif/40d0bbff-bed5-4cd1-86e7-047703c0d514__640/full/!600,600/0/default.jpg" width="250" height="250" />


## Intro

I recently visited an exhibition of Escher's works in Florence. It was fantastic and I was fascinated by the different details and all the optical elements in the various works. 

I wanted to try stable diffusion myself and so I got the idea to connect these obsessions to experiment with generative AI and write something about it.

In particular, I was interested in seeing how an AI trained on millions of data points like Stable Diffusion could complete Escher's work 'Print Gallery', which is Escher's only incomplete work. Actually, in the 00s a mathematician was able to complete it with a thesis and specific formulas, and if you are interested (believe me, he is) read this article. 

I then experimented with different prompts, some of which were generated by GPT-3 using Chat-GPT, but I also used some prompts from Lexica.com and others I created myself.

Now let's dive into this beautiful experiment and see the different results.

First of all, I should explain that I used two different masks to see the difference between the outcomes

### Mask 1

![Print Gallery Escher](/assets/pictures/Escher/mask.png)

### Mask 2

![Print Gallery Escher](/assets/pictures/Escher/mask_2.png)

### Results Mask 1
0."*an illusionist geometric painting in sepia style, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_0_mask1.jpg)

In the 2nd and 3rd pictures, it realizes something similar to what I wrote and it can connect the new image with the original one.

1."*a street in a maze of many doorways and windows and boats and lots of stairs, many doorways, inside MC Escher architecture, artstation, Junji Ito, epic composition, detailed background*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_1_mask1.jpg)

Here I used a lot more details to understand how the algorithm could interpret my words and descriptions. It seems to be a little bit confusing since the results are more chaotic than the previous ones.

2."*a spiral of doorways, windows, boats and stairs, inside MC Escher architecture, artstation, epic composition, detailed background*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_2_mask1.jpg)

In this one I tried to remove some details and see what happens moreover a changed the initial text with ‘a spiral’ since I wanted that kind of effect, even if it doesn’t seem to get so well this description, maybe the first one can be taken into consideration. 

3."*an ornate illustration in the styles of mandalas and fractals, the styles of escher and penrose, depicting a weasel staring deep into the heart of the impossible all - and - nothing of the emerging singularity ; / what has god wrought? / he seems to be whispering.*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_3_mask1.jpg)

Ok also for this one I tried something really detailed and difficult to understand maybe also for real intelligence, even if I am satisfied enough with the results in general.

4."*a maze made out of stairs, glass spheres, bubbles, deep vibrant colors, pastel colors, insanely Intricate, exquisitely ornate, art by Maurits Cornelis Escher and Victor Vasarely and Rob Gonsalves*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_4_mask1.jpg)

I don’t know why it put a person inside the mask in this case, in general with this prompt seems to understand the kind of bubble and sphere shapes.

5."*epic mural of technological change through history by marcus akinlana, basil wolverton, mc escher, dali, picasso, hr giger, wheres waldo, cybernetic river of transformation*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_5_mask1.jpg)

Here I tried to insert more artistic style just to see if I could change the style of the painting in some way and indeed it does, he changed a lot of the elements inside and here there is also one of my favorite results which is the 2nd one with the spiral wall and the black hole inside.

6."*heavy armor battle tank painted in white and black yin - yang dao symbol firing at dystopia, cosmos backdrop, detailed pencil drawing escher style xenopunk alien aesthetics*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_6_mask1.jpg)

Also here I tried something similar to the previous one but the results are not so good actually…

7."*endless maze of stairs sketch art jim henson labyrinth*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_7_mask1.jpg)

Here is more simple prompt without commas or similars just saying what I would like to have, so a maze with a different artistic style. It seems to get something for the first two pictures but not more than strange stairs.

8."*a detailed illustration of a cosmic staircase that rises into itself, 4k, by M. C. Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_8_mask1.jpg)

More or less the aim of the prompt is the same as the previous one even if the results are a little bit better in my opinion.

9."*a detailed illustration of a spiral fractal, 4k, by M. C. Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_9_mask1.jpg)

I can produce an interesting result and they are detailed, except for the return of the spiral with a black hole

10."*a Droste effect drawing, 4k, by Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_10_mask1.jpg)

The last picture here is really interesting since it seems to get what a Droste effect is.

11."*a man in a gallery viewing a print of a seaport, and among the buildings in the seaport is the very gallery in which he is standing, making use of the Droste effect with visual recursion, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_11_mask1.jpg)

Well here I tried with the Wikipedia description of the painting, and I have to admit that the results in general are not so bad at all.

12."*a man in a gallery*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_12_mask1.jpg)

Really minimal prompt, maybe the 1st and the last ones are good but the other ones are weird, the 3rd one is not even be completed

13."*a man in a gallery among buildings and windows, Droste effect, recursive, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_13_mask1.jpg)

The 2nd and the 3rd ones are more interesting than all the other ones, but they still miss something.

14."*an optical illusion of man in a gallery among buildings and windows, Droste effect, recursive, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_14_mask1.jpg)

Here it was really really confusing, maybe I insert too many elements?

15."*an optical illusion of buildings and windows illustration, detailed*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_15_mask1.jpg)

So I tried with fewer elements but just for the last one, it gets what I described.

16."*an optical illusion of buildings and windows,detailed, 4k, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_16_mask1.jpg)

Just adding some more attributes to the prompt to see the differences, in reality, it seems to produce more detailed results.

17."*an optical illusion of buildings and windows, Droste effect, recursive, detailed, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_17_mask1.jpg)

Changing the list of attributes, the 4th one seems to get more or less the kind of the description

18."*an optical illusion of buildings and windows, Droste effect, recursive, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_18_mask1.jpg)

Dropping the detailed attribute, produced more interesting results in line with the description I wrote.

19."*escher architecture with buildings and boats, Droste effect, recursive, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_19_mask1.jpg)

I tried to insert more boats but nothing, really awkward result in the last one where it put just a spiral, maybe it’s getting to go lazy.

20."*escher architecture with buildings and boats, Droste effect, recursive*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_1/img_20_mask1.jpg)

Last try, same prompt but removed the artistic style. I think that just the first one is quite good all the others are really weird results.

### Results Mask 2
0."*an illusionist geometric painting in sepia style, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_0.jpg)

It produces really interesting results, here I’m so curious about the second one where it draws a strange figure or statue inside the mask.

1."*a street in a maze of many doorways and windows and boats and lots of stairs, many doorways, inside MC Escher architecture, artstation, Junji Ito, epic composition, detailed background*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_1.jpg)

The prompt probably is too detailed, it can be seen from the second image where it gets confused about what to reproduce.

2."*a spiral of doorways, windows, boats and stairs, inside MC Escher architecture, artstation, epic composition, detailed background*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_2.jpg)

In this case, there are some very interesting results, it seems to understand for example to insert the windows, then in the first one it drew a person (maybe a sailor?) and for the last two images it tried to do something bad really bad.

3."*an ornate illustration in the styles of mandalas and fractals, the styles of escher and penrose, depicting a weasel staring deep into the heart of the impossible all - and - nothing of the emerging singularity ; / what has god wrought? / he seems to be whispering.*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_3.jpg)

Yeah, probably this is a series of very ‘ornate’ illustrations, windows mixed with stairs, maybe some mandalas or fractals inside but that’s difficult to understand actually.

4."*a maze made out of stairs, glass spheres, bubbles, deep vibrant colors, pastel colors, insanely Intricate, exquisitely ornate, art by Maurits Cornelis Escher and Victor Vasarely and Rob Gonsalves*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_4.jpg)

I am pretty satisfied with these ones, it seems to understand well that I wanted a series of stairs, even if I cannot see any glass sphere or bubble.

5."*epic mural of technological change through history by marcus akinlana, basil wolverton, mc escher, dali, picasso, hr giger, wheres waldo, cybernetic river of transformation*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_5.jpg)

The results are very weird and chaotic, It draws now the bubble I asked for previously. 

6."*heavy armor battle tank painted in white and black yin - yang dao symbol firing at dystopia, cosmos backdrop, detailed pencil drawing escher style xenopunk alien aesthetics*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_6.jpg)

I asked for a heavy armor battle tank, it drew stairs and windows, the overall results are not bad but it’s not what I wrote.

7."*endless maze of stairs sketch art jim henson labyrinth*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_7.jpg)

It tried to put a maze in the second one, for the rest the results are not so outstanding

8."*a detailed illustration of a cosmic staircase that rises into itself, 4k, by M. C. Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_8.jpg)

Curious results, it can interpret probably the attributes except for cosmic, but there is some sort of staircase that rises into itself.

9."*a detailed illustration of a spiral fractal, 4k, by M. C. Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_9.jpg)

Really confusing results, probably it cannot understand so well how to put fractals and spiral together.

10."*a Droste effect drawing, 4k, by Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_10.jpg)

Mmh nothing too interesting to see here.

11."*a man in a gallery viewing a print of a seaport, and among the buildings in the seaport is the very gallery in which he is standing, making use of the Droste effect with visual recursion, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_11.jpg)

I can see the boats and the seaport, all the rest are really confused creations.

12."*a man in a gallery*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_12.jpg)

It produces more geometric results here, the one with the triangle is really cool actually, anyway I don’t see any man in a gallery.

13."*a man in a gallery among buildings and windows, Droste effect, recursive, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_13.jpg)

Ok Probably here I was more detailed than before and it draws some buildings and windows, but still no man in a gallery.

14."*an optical illusion of man in a gallery among buildings and windows, Droste effect, recursive, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_14.jpg)

It seems to get what I wrote but when it tries to mix them it produces very confused results such as the last one.

15."*an optical illusion of buildings and windows illustration, detailed*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_15.jpg)

No optical illusion, there are some buildings but it’s not very detailed in this case

16."*an optical illusion of buildings and windows,detailed, 4k, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_16.jpg)

Here effectively it produces more detailed draws than the previous ones but is still confused about the optical illusion.

17."*an optical illusion of buildings and windows, Droste effect, recursive, detailed, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_17.jpg)

These results are well done, probably the recursive attribute helped to get what I would like to see.

18."*an optical illusion of buildings and windows, Droste effect, recursive, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_18.jpg)

It draws finally a sort of Droste effect, it is still really confused with the optical illusion but I got it, anyway I like the last two results.

19."*escher architecture with buildings and boats, Droste effect, recursive, Maurits Cornelis Escher*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_19.jpg)

These results are cool and probably are my favorite ones, it draws a kind of architecture mixed with boats and a Droste effect.

20."*escher architecture with buildings and boats, Droste effect, recursive*"

![Print Gallery Escher](/assets/pictures/Escher/escher_mask_2/img_20.jpg)

These ones are well, the results are surely very similar to the previous ones so probably writing the artistic style is redundant.

## Papers and other similar projects

During my research on other completion or similar projects, I found a paper that is also quite recent since it has been published in May 2022 and is a comparison between GANs and Diffusion models by completing the Escher Print Gallery painting.

Comparison of CoModGANs, LaMa and GLIDE for Art Inpainting- Completing M.C Escher's Print Gallery
Lucia Cipolina-Kun, Simone Caenazzo, Gaston Mazzei

Cite as : [arXiv:2205.01741](https://arxiv.org/abs/2205.01741)

In this article, they tried and compared different inpainting models in particular CoModGANs [21], LaMa [19] and GLIDE [1] and they used them for restorative inpainting doing something similar to what I did so far with Stable diffusion, to try to complete the hole inside the incomplete artwork of Escher ‘Print Gallery’.

Eventually, they found that the best one, in this case, was GLIDE which is a diffusion model and performs better than the other ones which are GANs. Like Stable Diffusion., the results depend on many variables, Guidance, Temperature, Prompt and Mask. The final result down below is the best one that they cherry-picked from other tentatives. Interestingly, most of their results are similar to the ones that I had with SD.

![GLIDE_result](/assets/pictures/Escher/Paper/GLIDE_0.png)

![GLIDE_result_zoom](/assets/pictures/Escher/Paper/GLIDE_1.png)


The real solution to the incomplete painting was given by the mathematician Hendrik Lenstra and his colleagues who achieved to fill the gap in the work of art with a formula and a computer program to calculate it and print it.

This is the completed result

![Lenstra](/assets/pictures/Escher/Lenstra.jpg)

If you are interested in that [here](https://www.universiteitleiden.nl/en/news/2020/04/how-mathematician-hendrik-lenstra-completed-an-unfinished-artwork-by-escher) there is the article that explains more in detail what and how they made it.


## Video

Astonishing video of the completed Print Gallery painting.

{% include embed.html url="https://www.youtube.com/embed/9WHdyG9mJaI" %} 

## Conclusions

This was a really interesting experiment to do with Stable Diffusion and generative ai model in general. It wasn't an easy job, since the Print Gallery painting is a really complicated and ornate artwork, moreover, it has to take into consideration also all the variables inside the Stable Diffusion model, like guidance, temperature, the prompt and of course the masks. 

Also from the results of other similar projects, it was difficult to reproduce and get a detailed image to complete the painting, of course it was possible from a mathematical point of view (probably the right one) but artistically speaking it was amazing to see what SD has generated and try to figure it out all the results and why it did it like that. I think that this is the most enjoyable part of all this experiment. 

If you want to have a try you can find the colab notebook with the code here where you can also find the folder with all the masks and results.
